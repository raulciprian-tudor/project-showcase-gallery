<div class="projects-container bg-primary px-md py-xl">
  <h1
    class="text-xxxl font-bold leading-tight tracking-tight text-primary text-center text-uppercase mb-xl"
  >
    Project Gallery
  </h1>

  <div class="toolbar-container">
    <app-filter
      (filterChange)="onFilterChange($event)"
      [availableTechs]="(availableTechs$ | async) || []"
      [initialSelectedTechs]="selectedTechs"
    />

    <div class="search-sort-group">
      <app-search-bar (searchChange)="onSearchChange($event)" [initialValue]="searchTerm" />

      <mat-form-field appearance="outline" class="sort-field">
        <mat-label>Sort by</mat-label>
        <mat-select [(value)]="sortOption" (selectionChange)="onSortChange()">
          <mat-option value="name-asc">Name (A-Z)</mat-option>
          <mat-option value="name-desc">Name (Z-A)</mat-option>
          <mat-option value="stars-desc">Most Stars</mat-option>
          <mat-option value="stars-asc">Least Stars</mat-option>
          <mat-option value="date-desc">Recently Updated</mat-option>
          <mat-option value="date-asc">Oldest First</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="view-controls">
      <mat-button-toggle-group [(value)]="viewMode">
        <mat-button-toggle value="grid">
          <mat-icon>grid_view</mat-icon>
        </mat-button-toggle>
        <mat-button-toggle value="list">
          <mat-icon>view_list</mat-icon>
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>
  </div>

  @if (filteredProjects$ | async; as projects) {
  <!-- Grid View -->
  @if (viewMode === 'grid') {
  <mat-grid-list [cols]="cols$ | async" rowHeight="1:1" gutterSize="10px" class="grid-view">
    @for(project of projects; track project.id) {
    <mat-grid-tile>
      <app-project-card [project]="project"></app-project-card>
    </mat-grid-tile>
    }
  </mat-grid-list>
  }

  <!-- List View -->
  @if (viewMode === 'list') {
  <div class="list-view">
    @for(project of projects; track project.id) {
    <app-project-card [project]="project" class="list-item"> </app-project-card>
    }
  </div>
  } }
</div>
